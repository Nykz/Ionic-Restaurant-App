import{a as m}from"./chunk-VR272TB5.js";import{c as p,f as u,j as d,l as g,r as f,sa as y}from"./chunk-36II4WRS.js";import{f as c}from"./chunk-RW4GY4BD.js";var C=(()=>{let l=class l{get places(){return this._places.asObservable()}get markerChange(){return this._markerChange.asObservable()}constructor(o,t){this.http=o,this.zone=t,this._places=new p([]),this._markerChange=new p({})}loadGoogleMaps(){let o=window,t=o.google;return t&&t.maps?Promise.resolve(t.maps):new Promise((r,a)=>{let e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key="+m.googleMapsApiKey+"&libraries=places&callback=Function.prototype",e.async=!0,e.defer=!0,document.body.appendChild(e),e.onload=()=>{let s=o.google;s&&s.maps?r(s.maps):a("Google Map SDK is not Available")}})}getAddress(o,t){return new Promise((r,a)=>{this.http.get(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${o},${t}&key=${m.googleMapsApiKey}`).pipe(u(e=>{if(!e||!e.results||e.results.length===0)throw null;return e.results[0]})).subscribe({next:e=>{r(e)},error:e=>{a(e)}})})}getPlaces(o){return c(this,null,function*(){try{this.googleMaps||(this.googleMaps=yield this.loadGoogleMaps());let t=this.googleMaps;console.log("maps: ",this.googleMaps),new t.places.AutocompleteService().getPlacePredictions({input:o,componentRestrictions:{country:"IN"}},a=>{let e=[];this.zone.run(()=>{a!=null&&(a.forEach(s=>c(this,null,function*(){console.log("prediction: ",s);let n=yield this.geoCode(s.description,t),h={title:s.structured_formatting.main_text,address:s.description,lat:n.lat,lng:n.lng};console.log("places: ",h),e.push(h)})),this._places.next(e))})})}catch(t){console.log(t)}})}geoCode(o,t){let r={lat:"",lng:""};return new Promise((a,e)=>{new t.Geocoder().geocode({address:o},n=>{console.log("results: ",n),r.lat=n[0].geometry.location.lat(),r.lng=n[0].geometry.location.lng(),a(r)})})}changeMarkerInMap(o){this._markerChange.next(o)}};l.\u0275fac=function(t){return new(t||l)(g(y),g(f))},l.\u0275prov=d({token:l,factory:l.\u0275fac,providedIn:"root"});let i=l;return i})();export{C as a};
