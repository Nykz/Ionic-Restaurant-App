import{a as fe}from"./chunk-SG7NFAYP.js";import{a as _e}from"./chunk-UX7P3H4G.js";import{B as ue,a as pe,g as ge,i as he}from"./chunk-3XMFGL7I.js";import{b as me}from"./chunk-E27WRCEQ.js";import{a as de,b as le}from"./chunk-FL3AVRJI.js";import{$ as j,$a as q,$b as ce,A as b,B as s,D as w,Ga as V,Hb as ie,J as c,K as a,Kb as re,L as m,La as $,M as k,Mb as ae,N as S,Nb as se,O as E,P as M,Q as u,S as Z,T as B,U as L,Va as Q,Vb as C,W as f,X as P,Ya as G,aa as z,ba as F,c as y,eb as Y,ga as W,ia as A,j as x,jb as v,l as I,ma as D,mb as J,n as O,na as N,nb as K,o as T,pb as X,qa as U,rb as ee,sb as te,t as r,u as g,va as H,x as _,xa as R,xb as ne,zb as oe}from"./chunk-36II4WRS.js";import"./chunk-HTSKCE6I.js";import"./chunk-7KGURMOZ.js";import"./chunk-G2NBWZGV.js";import"./chunk-5ZMMP3RU.js";import"./chunk-NOFUNQAN.js";import"./chunk-TIZDWYJD.js";import"./chunk-GF5ML23A.js";import"./chunk-G3CV3VGG.js";import"./chunk-JX3TYZ34.js";import"./chunk-RUY5SX76.js";import"./chunk-NIOQNOHM.js";import"./chunk-4U6PRYVA.js";import"./chunk-BE36LD5W.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as p}from"./chunk-RW4GY4BD.js";var Ce=(()=>{let n=class n{constructor(){}ngOnInit(){}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=_({type:n,selectors:[["app-chat-box"]],inputs:{chat:"chat"},decls:9,vars:9,consts:[["lines","none"],[1,"ion-text-wrap","container",3,"slot"],[1,"time"],["name","checkmark-done-outline",3,"color"]],template:function(e,t){e&1&&(c(0,"ion-item",0)(1,"div",1)(2,"ion-text"),f(3),a(),c(4,"ion-note",2)(5,"small"),f(6),W(7,"date"),a(),m(8,"ion-icon",3),a()()()),e&2&&(w((t.chat==null?null:t.chat.senderType)=="admin"?"admin":"user"),r(),s("slot",(t.chat==null?null:t.chat.senderType)!="admin"?"end":"start"),r(2),P(t.chat==null?null:t.chat.message),r(3),P(A(7,6,t.chat==null?null:t.chat.timestamp,"HH:mm")),r(2),s("color",(t.chat==null?null:t.chat.senderType)=="admin"?"primary":"white"))},dependencies:[ee,re,oe,C,U],styles:['ion-item[_ngcontent-%COMP%]{--background: transparent;--padding-start: 8px;--padding-end: 0px;--ion-safe-area-left: 0px;--min-height: 32px;--border-width: 0}ion-item[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{position:relative;border-radius:12px;padding:5px 8px;margin-top:12px;max-width:70%}ion-item[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{font-weight:400;font-size:.9rem}ion-item[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]:after{content:"";width:52px;height:12px;display:inline-block;vertical-align:top;visibility:hidden;font-size:.75rem}ion-item[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{position:absolute;display:flex;right:0;bottom:0;padding:4px 8px 4px 4px;line-height:16px;pointer-events:auto;color:var(--ion-color-medium)}.admin[_ngcontent-%COMP%]:after{content:"";position:absolute;border:0 solid transparent;border-top-color:transparent;border-top-style:solid;border-top-width:0px;border-top:9px solid var(--ion-color-light);border-radius:0 20px;width:15px;height:30px;transform:rotate(115deg);bottom:-8px;left:-4px}.admin[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{margin-left:8px;background-color:var(--ion-color-light)}.admin[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]:after{width:72px!important}.admin[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{margin-right:2px;line-height:16px}.admin[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}.user[_ngcontent-%COMP%]:after{content:"";position:absolute;border:0 solid transparent;border-bottom-color:transparent;border-bottom-style:solid;border-bottom-width:0px;border-bottom:9px solid var(--ion-color-primary);border-radius:20px 0;width:15px;height:30px;transform:rotate(70deg);bottom:-8px;right:-4px}.user[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{background-color:var(--ion-color-primary)}.user[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]{color:var(--ion-color-white)}.user[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   ion-text[_ngcontent-%COMP%]:after{width:72px!important}.user[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{color:#ffa07a}.user[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{margin-right:2px;line-height:16px}.user[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:16px}']});let i=n;return i})();var ye=[{id:"1",message:"I am facing an issue with my order.",senderType:"user",senderId:"6",timestamp:"2023-07-28T08:30:00.000Z",orderId:"2"},{id:"2",message:"Sure, I'll assist you with that. What seems to be the problem?",senderType:"admin",senderId:"56789",timestamp:"2023-07-28T08:35:00.000Z",orderId:"2"},{id:"3",message:"My order is delayed and hasn't arrived yet.",senderType:"user",senderId:"6",timestamp:"2023-07-28T09:00:00.000Z",orderId:"2"},{id:"4",message:"Apologies for the delay. Let me check the status of your order.",senderType:"admin",senderId:"56789",timestamp:"2023-07-28T09:10:00.000Z",orderId:"2"},{id:"5",message:"Thank you for your assistance.",senderType:"user",senderId:"6",timestamp:"2023-07-28T09:15:00.000Z",orderId:"2"},{id:"6",message:"I am facing an issue with my order.",senderType:"user",senderId:"6",timestamp:"2023-07-28T08:30:00.000Z",orderId:"3"},{id:"7",message:"We apologize for any inconvenience caused. Please let us know the problem in detail so that we can assist you better.",senderType:"admin",senderId:"56789",timestamp:"2023-07-28T08:35:00.000Z",orderId:"3"},{id:"8",message:"My order arrived, but the items were missing.",senderType:"user",senderId:"6",timestamp:"2023-07-28T09:00:00.000Z",orderId:"3"},{id:"9",message:"We apologize for the oversight. Can you please provide the details of the missing items?",senderType:"admin",senderId:"56789",timestamp:"2023-07-28T09:10:00.000Z",orderId:"3"},{id:"10",message:"My order was delivered on time. Thank you!",senderType:"user",senderId:"6",timestamp:"2023-07-28T12:30:00.000Z",orderId:"4"},{id:"11",message:"You're welcome! We strive to provide the best service. If you have any other questions, feel free to ask.",senderType:"admin",senderId:"56789",timestamp:"2023-07-28T12:35:00.000Z",orderId:"4"},{id:"12",message:"I am facing an issue with my delivered order. The food was not properly packed and leaked during transit.",senderType:"user",senderId:"6",timestamp:"2023-07-28T13:00:00.000Z",orderId:"4"},{id:"13",message:"We apologize for the inconvenience. Please accept our sincere apologies. We will investigate and take necessary actions to prevent this in the future.",senderType:"admin",senderId:"56789",timestamp:"2023-07-28T13:10:00.000Z",orderId:"4"}];var Ie=(()=>{let n=class n{get messages(){return this.messages$.asObservable()}constructor(o,e){this.auth=o,this.api=e,this.changeOrder=new y(null),this.messages$=new y([])}getUid(){return p(this,null,function*(){return this.uid||(this.uid=yield this.auth.getId()),this.uid})}getChats(o){return p(this,null,function*(){try{yield this.api.delayedResponse(500),this.changeOrder.next(o);let e=ye.filter(t=>t.orderId==o);console.log(e),this.messages$.next(e)}catch(e){throw e}})}sendMessage(o){this.getUid();let e=this.changeOrder.value;console.log(e);let t={id:"1",message:o,senderType:de.TYPE,senderId:this.uid,timestamp:new Date().toISOString(),orderId:e},l=this.messages$.value;l.push(t),this.messages$.next(l)}reset(){this.uid=null,this.changeOrder.next(null),this.messages$.next([])}};n.\u0275fac=function(e){return new(e||n)(I(me),I(fe))},n.\u0275prov=x({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();function Pe(i,n){if(i&1&&m(0,"app-empty-screen",10),i&2){let d=u();s("model",d.model)}}function ve(i,n){if(i&1&&(c(0,"ion-item-group",13),m(1,"app-chat-box",14),a()),i&2){let d=n.$implicit;r(),s("chat",d)}}function xe(i,n){if(i&1&&(k(0),c(1,"ion-list",11),b(2,ve,2,1,"ion-item-group",12),a(),S()),i&2){let d=u();r(2),s("ngForOf",d.chats)}}function Oe(i,n){if(i&1){let d=E();c(0,"ion-fab-button",15),M("click",function(){O(d);let e=u();return T(e.sendMessage())}),m(1,"ion-icon",16),a()}if(i&2){let d=u();s("disabled",!d.message||d.message.trim()=="")}}function Te(i,n){i&1&&(c(0,"ion-fab-button",17),m(1,"ion-spinner",18),a())}var qe=(()=>{let n=class n{constructor(o,e,t,l,h){this.router=o,this.route=e,this.navCtrl=t,this.chatService=l,this.global=h,this.model={icon:"chatbubbles-outline",title:"No inbox message",color:"danger"},this.chats=[],this.isLoading=!1,pe({send:ue,chatbubblesOutline:ge,checkmarkDoneOutline:he})}ngOnInit(){let o=this.route.snapshot.paramMap.get("id");if(console.log("check id: ",o),!o){this.navCtrl.back();return}this.order_id=o,console.log("id: ",this.order_id),this.getChats(),this.chatService.messages.subscribe({next:e=>{this.chats=e}})}getChats(){return p(this,null,function*(){try{console.log("getchats"),this.global.showLoader(),yield this.chatService.getChats(this.order_id),this.global.hideLoader()}catch{this.global.hideLoader(),this.global.errorToast()}})}ngAfterViewChecked(){this.scrollToBottom()}checkUrl(){let o=this.router.url.split("/"),e=o.splice(o.length-2,2);this.urlCheck=e[0],o.push(this.urlCheck),this.url=o}getPreviousUrl(){return this.checkUrl(),this.url.join("/")}sendMessage(){return p(this,null,function*(){try{this.isLoading=!0,this.chatService.sendMessage(this.message),this.message="",this.isLoading=!1,this.scrollToBottom()}catch(o){this.isLoading=!1,console.log(o),this.global.errorToast()}})}scrollToBottom(){console.log("scroll bottom"),this.chats&&this.content.scrollToBottom(500)}scrollToTop(){this.content.scrollToTop(1500)}ngOnDestroy(){this.chatSub&&this.chatSub.unsubscribe(),this.chatService.reset()}};n.\u0275fac=function(e){return new(e||n)(g(R),g(H),g(G),g(Ie),g(le))},n.\u0275cmp=_({type:n,selectors:[["app-chat"]],viewQuery:function(e,t){if(e&1&&Z(v,5),e&2){let l;B(l=L())&&(t.content=l.first)}},decls:15,vars:6,consts:[[3,"click"],["slot","start"],[3,"defaultHref"],[3,"model",4,"ngIf"],[4,"ngIf"],[1,"ion-no-border"],["autoGrow","","rows","1","placeholder","Send message",1,"ion-text-center",3,"ngModelChange","ngModel"],["slot","end"],["color","primary","size","large",3,"disabled","click",4,"ngIf"],["color","primary","size","large",4,"ngIf"],[3,"model"],["lines","none"],["class","chats-group",4,"ngFor","ngForOf"],[1,"chats-group"],[3,"chat"],["color","primary","size","large",3,"click","disabled"],["name","send"],["color","primary","size","large"],["name","crescent","color","white"]],template:function(e,t){e&1&&(c(0,"ion-header")(1,"ion-toolbar")(2,"ion-title",0),M("click",function(){return t.scrollToTop()}),f(3,"MAZA EATS SUPPORT"),a(),c(4,"ion-buttons",1),m(5,"ion-back-button",2),a()()(),c(6,"ion-content"),b(7,Pe,1,1,"app-empty-screen",3)(8,xe,3,1,"ng-container",4),a(),c(9,"ion-footer",5)(10,"ion-toolbar")(11,"ion-textarea",6),F("ngModelChange",function(h){return z(t.message,h)||(t.message=h),h}),a(),c(12,"ion-buttons",7),b(13,Oe,2,1,"ion-fab-button",8)(14,Te,2,0,"ion-fab-button",9),a()()()),e&2&&(r(5),s("defaultHref",t.getPreviousUrl()),r(2),s("ngIf",(t.chats==null?null:t.chats.length)==0),r(),s("ngIf",(t.chats==null?null:t.chats.length)>0),r(3),j("ngModel",t.message),r(2),s("ngIf",!t.isLoading),r(),s("ngIf",t.isLoading))},dependencies:[X,se,ae,Y,q,v,ne,te,K,ce,C,J,ie,N,D,Q,V,$,_e,Ce],styles:["ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{background:transparent}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]{padding-left:3px;padding-right:3px}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-textarea[_ngcontent-%COMP%]{border:1px solid var(--ion-color-medium);border-radius:10px;margin:.5vh 0}ion-footer[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-buttons[_ngcontent-%COMP%]{margin-left:1.5vh}"]});let i=n;return i})();export{qe as ChatPage};
