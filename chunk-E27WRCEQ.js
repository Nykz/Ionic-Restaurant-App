import{a as c,b as U,c as v}from"./chunk-FL3AVRJI.js";import{c as y,j as l,l as h,m as w,xa as S}from"./chunk-36II4WRS.js";import{f as a}from"./chunk-RW4GY4BD.js";var p=class{constructor(s,N,t,i,n,r,d,e,u,D,I){this.email=s,this.phone=N,this.name=t,this.id=i,this.type=n,this.status=r,this.photo=d,this.vehicle=e,this.latitude=u,this.longitude=D,this.current_duty=I}};var g=class{constructor(s){this.uid=s}},G=(()=>{let s=class s{constructor(t,i){this.router=t,this.storage=i,this._uid=new y(s.UNKNOWN_USER),this.global=w(U)}login(t,i){return a(this,null,function*(){try{let n={email:t,password:i},r={id:"6"};return this.setUserData(r==null?void 0:r.id),r}catch(n){throw n}})}getId(){return a(this,null,function*(){let t=this._uid.value;return console.log("auth restaurant user id: ",t==null?void 0:t.uid),t!=null&&t.uid?t.uid:(yield this.storage.getStorage(c.UID)).value})}setUserData(t){this.storage.setStorage(c.UID,t),this._uid.next(new g(t))}register(t){return a(this,null,function*(){var i,n;try{let r=new p(t.email,t.phone,t.name,null,c.TYPE,"active"),d="6",e=new FormData;return t.description&&e.append("description",t.description),e.append("cover",t.imageFile,t.imageFile.name),e.append("name",t.name),e.append("email",t.email),e.append("phone",t.phone),e.append("password",t.password),e.append("name",t==null?void 0:t.restaurant_name),e.append("openTime",t.openTime),e.append("closeTime",t.closeTime),e.append("price",t.price.toString()),e.append("city_id",t.city),e.append("delivery_time",t.delivery_time.toString()),e.append("address",t.address.address),e.append("status","active"),e.append("cuisines",JSON.stringify(t.cuisines)),e.append("categories",JSON.stringify(t.categories)),e.append("latitude",JSON.stringify((i=t==null?void 0:t.address)==null?void 0:i.lat)),e.append("longitude",JSON.stringify((n=t==null?void 0:t.address)==null?void 0:n.lng)),yield this.setUserData(d),{id:d,type:c.TYPE}}catch(r){throw r}})}sendResetPasswordOtp(t){return a(this,null,function*(){try{let i={email:t};return null}catch(i){throw i}})}verifyResetPasswordOtp(t,i){return a(this,null,function*(){try{let n={email:t,reset_password_token:i};return null}catch(n){throw n}})}resetPassword(t){return a(this,null,function*(){try{return null}catch(i){throw i}})}logout(){return a(this,null,function*(){try{return yield this.storage.removeStorage(c.UID),this._uid.next(s.UNKNOWN_USER),!0}catch(t){throw t}})}updateEmail(t,i,n){return a(this,null,function*(){try{}catch(r){throw console.log(r),r}})}autoLoginGuard(){return a(this,null,function*(){try{return(yield this.getId())?(this.global.navigateByUrl(c.TABS),!1):!0}catch(t){throw t}})}introGuard(){return a(this,null,function*(){let t=yield this.storage.getStorage(c.INTRO_KEY);return t&&t.value=="true"?!0:(this.router.navigateByUrl("/intro",{replaceUrl:!0}),!1)})}authGuard(){return a(this,null,function*(){try{let t=yield this.getId();return t?(this.setUserData(t),!0):(this.router.navigateByUrl(c.LOGIN,{replaceUrl:!0}),!1)}catch(t){throw t}})}getUserData(){return a(this,null,function*(){let t=yield this.storage.getStorage(c.UID);return{uid:t==null?void 0:t.value}})}};s.UNKNOWN_USER=null,s.\u0275fac=function(i){return new(i||s)(h(S),h(v))},s.\u0275prov=l({token:s,factory:s.\u0275fac,providedIn:"root"});let o=s;return o})();export{p as a,G as b};
